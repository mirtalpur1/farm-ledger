<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Consolidated Farm Settlement Ledger</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        h1 {
            text-align: center;
        }
        form {
            max-width: 600px;
            margin: 0 auto;
        }
        input, select {
            margin: 5px;
        }
        .expense-list {
            margin-top: 10px;
        }
        .settlement {
            max-width: 600px;
            margin: 20px auto;
            border: 1px solid #ccc;
            padding: 10px;
        }
        .section {
            margin-bottom: 20px;
        }
        .red {
            color: red;
        }
    </style>
</head>
<body>
    <h1>Consolidated Farm Settlement Ledger</h1>
    <form id="ledgerForm">
        <label for="name">Sharecropper Name:</label>
        <input type="text" id="name" value="Lakhman"><br>

        <label for="advance">Cash Advance to Sharecropper (PKR):</label>
        <input type="number" id="advance" value="125000"><br>

        <label for="revenue">Total Crop Revenue (PKR):</label>
        <input type="number" id="revenue" value="0"><br>

        <div class="section">
            <label>Expenses Paid By Owner:</label><br>
            <select id="ownerExpenseType">
                <option>Ploughing</option>
                <option>Fertilizer</option>
                <option>Seeds</option>
                <option>Labour</option>
                <option>Other</option>
            </select>
            <input type="number" id="ownerExpenseAmount" placeholder="Amount">
            <button type="button" onclick="addExpense('owner')">Add Expense</button>
            <div id="ownerExpenses" class="expense-list"></div>
        </div>

        <div class="section">
            <label>Expenses Paid By Sharecropper:</label><br>
            <select id="sharecropperExpenseType">
                <option>Fertilizer</option>
                <option>Seeds</option>
                <option>Labour</option>
                <option>Other</option>
            </select>
            <input type="number" id="sharecropperExpenseAmount" placeholder="Amount">
            <button type="button" onclick="addExpense('sharecropper')">Add Expense</button>
            <div id="sharecropperExpenses" class="expense-list"></div>
        </div>

        <button type="button" onclick="calculateSettlement()">Calculate Settlement</button>
        <button type="button" onclick="resetForm()">Reset</button>
    </form>

    <div id="result"></div>

    <script>
        let ownerExpenses = [];
        let sharecropperExpenses = [];

        function addExpense(type) {
            let typeSelect = document.getElementById(type + 'ExpenseType');
            let amountInput = document.getElementById(type + 'ExpenseAmount');
            let expenseType = typeSelect.value;
            let amount = parseFloat(amountInput.value);

            if (isNaN(amount) || amount <= 0) {
                alert('Please enter a valid amount.');
                return;
            }

            let expense = { type: expenseType, amount: amount };

            if (type === 'owner') {
                ownerExpenses.push(expense);
                displayExpenses('owner');
            } else {
                sharecropperExpenses.push(expense);
                displayExpenses('sharecropper');
            }

            amountInput.value = '';
        }

        function displayExpenses(type) {
            let container = document.getElementById(type + 'Expenses');
            container.innerHTML = '';
            let expenses = type === 'owner' ? ownerExpenses : sharecropperExpenses;
            expenses.forEach((exp, index) => {
                let div = document.createElement('div');
                div.textContent = `${exp.type}: PKR ${exp.amount.toLocaleString()}`;
                container.appendChild(div);
            });
        }

        function resetForm() {
            ownerExpenses = [];
            sharecropperExpenses = [];
            document.getElementById('ownerExpenses').innerHTML = '';
            document.getElementById('sharecropperExpenses').innerHTML = '';
            document.getElementById('result').innerHTML = '';
            document.getElementById('ledgerForm').reset();
        }

        function calculateSettlement() {
            let name = document.getElementById('name').value;
            let advance = parseFloat(document.getElementById('advance').value) || 0;
            let revenue = parseFloat(document.getElementById('revenue').value) || 0;
            let C_o = ownerExpenses.reduce((sum, exp) => sum + exp.amount, 0);
            let C_s = sharecropperExpenses.reduce((sum, exp) => sum + exp.amount, 0);
            let C = C_o + C_s;

            if (revenue < C) {
                alert('Revenue should be greater than total costs for meaningful profits.');
            }

            let resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<h2>Settlement Comparison for ${name}</h2>`;

            // Business Principles: S = 0.5
            let S_b = 0.5;
            let owed_b = advance + C_o - S_b * C;
            let owner_net_b = S_b * (revenue - C);
            let sharecropper_owes_b = owed_b > 0 ? `Sharecropper owes owner PKR ${owed_b.toLocaleString()}` : `Owner owes sharecropper PKR ${(-owed_b).toLocaleString()}`;

            resultDiv.innerHTML += `
                <div class="settlement">
                    <h3>Business Principles</h3>
                    <p>Owner's final net profit: PKR ${owner_net_b.toLocaleString()}</p>
                    <p>${sharecropper_owes_b}</p>
                </div>
            `;

            // Customary Principles: S = 0.4 (2/5 owner, 3/5 sharecropper)
            let S_c = 0.4;
            let owed_c = advance + C_o - S_c * C;
            let owner_net_c = S_c * (revenue - C);
            let sharecropper_owes_c = owed_c > 0 ? `Sharecropper owes owner PKR ${owed_c.toLocaleString()}` : `Owner owes sharecropper PKR ${(-owed_c).toLocaleString()}`;

            resultDiv.innerHTML += `
                <div class="settlement">
                    <h3>Customary Principles</h3>
                    <p>Owner's final net profit: PKR ${owner_net_c.toLocaleString()}</p>
                    <p>${sharecropper_owes_c}</p>
                </div>
            `;
        }
    </script>
</body>
</html>
